# -*- coding: utf-8 -*-
"""TF-IDF.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1_DDFZC0-gwAXvm2FJN3Z-el4_1LanxeH

### **Ø¨Ø§ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Scikit-learn**
"""

!pip install -U scikit-learn

from sklearn.feature_extraction.text import TfidfVectorizer

# Ù„ÛŒØ³ØªÛŒ Ø§Ø² Ø§Ø³Ù†Ø§Ø¯ (Ù‡Ø± Ø³Ù†Ø¯ ÛŒÚ© Ø¬Ù…Ù„Ù‡ ÛŒØ§ Ù¾Ø§Ø±Ø§Ú¯Ø±Ø§Ù)
documents = [
    "Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø¢ÛŒÙ†Ø¯Ù‡ Ø±Ø§ ØªØºÛŒÛŒØ± Ø®ÙˆØ§Ù‡Ø¯ Ø¯Ø§Ø¯",
    "ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ù…Ø§Ø´ÛŒÙ† ÛŒÚ©ÛŒ Ø§Ø² Ø´Ø§Ø®Ù‡â€ŒÙ‡Ø§ÛŒ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø§Ø³Øª",
    "Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø¯Ø± Ù¾Ø²Ø´Ú©ÛŒ Ùˆ Ø¢Ù…ÙˆØ²Ø´ Ú©Ø§Ø±Ø¨Ø±Ø¯ Ø¯Ø§Ø±Ø¯"
]

# Ø³Ø§Ø®Øª TF-IDF Ù…Ø¯Ù„
vectorizer = TfidfVectorizer()
X = vectorizer.fit_transform(documents)

# Ù†Ù…Ø§ÛŒØ´ Ú©Ù„Ù…Ø§Øª Ùˆ ÙˆØ²Ù† TF-IDF
words = vectorizer.get_feature_names_out()

for doc_index, doc_vector in enumerate(X.toarray()):
    print(f"\nðŸ”¹ Ø³Ù†Ø¯ {doc_index + 1}:")
    for word_index, score in enumerate(doc_vector):
        if score > 0:
            print(f"{words[word_index]}: {score:.4f}")

"""### **Ø¨Ø¯ÙˆÙ† Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡**"""

import math
from collections import Counter

# Ø³Ù†Ø¯Ù‡Ø§
documents = [
    "Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø¢ÛŒÙ†Ø¯Ù‡ Ø±Ø§ ØªØºÛŒÛŒØ± Ø®ÙˆØ§Ù‡Ø¯ Ø¯Ø§Ø¯",
    "ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ù…Ø§Ø´ÛŒÙ† ÛŒÚ©ÛŒ Ø§Ø² Ø´Ø§Ø®Ù‡â€ŒÙ‡Ø§ÛŒ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø§Ø³Øª",
    "Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø¯Ø± Ù¾Ø²Ø´Ú©ÛŒ Ùˆ Ø¢Ù…ÙˆØ²Ø´ Ú©Ø§Ø±Ø¨Ø±Ø¯ Ø¯Ø§Ø±Ø¯"
]

# Ù¾ÛŒØ´â€ŒÙ¾Ø±Ø¯Ø§Ø²Ø´: Ø¬Ø¯Ø§ Ú©Ø±Ø¯Ù† Ú©Ù„Ù…Ø§Øª
tokenized_docs = [doc.split() for doc in documents]

# ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ø³Ù†Ø¯Ù‡Ø§
N = len(tokenized_docs)

# Ù…Ø­Ø§Ø³Ø¨Ù‡ DF: Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ú©Ù„Ù…Ù‡ Ø¯Ø± Ú†Ù†Ø¯ Ø³Ù†Ø¯ Ø¸Ø§Ù‡Ø± Ø´Ø¯Ù‡ØŸ
df = {}
for doc in tokenized_docs:
    unique_words = set(doc)
    for word in unique_words:
        df[word] = df.get(word, 0) + 1

# Ù…Ø­Ø§Ø³Ø¨Ù‡ TF-IDF
for doc_index, doc in enumerate(tokenized_docs):
    print(f"\nðŸ”¹ Ø³Ù†Ø¯ {doc_index + 1}:")
    word_counts = Counter(doc)
    total_words = len(doc)

    for word in word_counts:
        tf = word_counts[word] / total_words
        idf = math.log(N / (1 + df[word]))
        tfidf = tf * idf
        print(f"{word}: {tfidf:.4f}")